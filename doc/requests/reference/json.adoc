## json.hpp
[#reference::json]

[source,cpp]
----
namespace boost::requests::json
{


// read an entire body as json and convert the json value into a `json::value`.
json::value read_json(stream & str, json::storage_ptr ptr = {});

json::value read_json(stream & str, json::storage_ptr ptr, system::error_code & ec);

template<asio::completion_token_for<void (boost::system::error_code, json::value)> CompletionToken
              asio::default_token_t<typename Stream::executor_type>>
auto async_read_json(
        stream & str,
        json::storage_ptr ptr = {},
        CompletionToken && token asio::default_token_t<typename Stream::executor_type>());


// read an entire body as json and convert the json value into a `json::value`
// if the response has a body. otherwise the result is empty.
optional<json::value> read_optional_json(stream & str, json::storage_ptr ptr = {});

optional<json::value> read_optional_json(stream & str, json::storage_ptr ptr, system::error_code & ec);

template<asio::completion_token_for<void (boost::system::error_code, optional<json::value>)> CompletionToken
            asio::default_token_t<typename Stream::executor_type>>
auto async_read_optional_json(
        stream & str,
        json::storage_ptr ptr = {},
        CompletionToken && token = asio::default_token_t<typename Stream::executor_type>());


/// the response of a json request
struct response : response_base
{
  using allocator_type = std::allocator<char>;
  using fields_type = http::fields;

  response(allocator_type alloc,         history_type history, json::value && value);
  response(http::response_header header, history_type history, json::value && value);

  response(allocator_type alloc        , json::value && value = {});
  response(http::response_header header, json::value && value = {});

  using value_type = json::value;
  value_type value;
};

// http-methods are , they follow the pattern below:
template<typename RequestBody, typename Connection>
auto ~method~(Connection & conn,
              /* target type of Connection */  target,
              RequestBody && request_body, // omitted for some methods.
              /* request type of Connection */  req = {},
              json::storage_ptr ptr = {}) -> response;

template<typename RequestBody, typename Connection>
auto ~method~(Connection & conn,
              /* target type of Connection */  target,
              RequestBody && request_body, // omitted for some methods.
              /* request type of Connection */ req,
              json::storage_ptr ptr,
              system::error_code & ec) -> response;

template<typename Connection, typename RequestBody,
          asio::completion_token_for<void (boost::system::error_code, response)> CompletionToken
              = asio::default_token_t<typename Connection::executor_type>>
auto async_~method~(Connection & conn,
        /* target type of Connection */ target,
        RequestBody && request_body,
        /* request type of Connection */ req = {},
        json::storage_ptr ptr = {},
        CompletionToken && token = asio::default_token_t<typename Connection::executor_type>());

// requests on the default_session
template<typename RequestBody>
auto ~method~(urls::url_view target,
              RequestBody && request_body, // omitted for some methods.
              http::fields req,
              json::storage_ptr ptr = {}) -> response;

template<typename RequestBody>
auto ~method~(urls::url_view target,
              RequestBody && request_body, // omitted for some methods.
              http::fields req,
              json::storage_ptr ptr,
              system::error_code & ec) -> response;

template<typename RequestBody,
          asio::completion_token_for<void (boost::system::error_code, response)> CompletionToken>
auto async_~method~(
        urls::url_view target,
        RequestBody && request_body,
        http::fields req,
        json::storage_ptr ptr = {},
        CompletionToken && token);


}
----

The json header contains methods to send and receive json messages.

Below is a table of all available methods.

Methods with an optional request body are overloaded.

[cols="1,1,1,1,1,1"]
|===
|Http Method | Name | Async-Name | Response body | Request Body | Remarks

| *GET*     | `get`     | `async_get`     | always   | never    |
| *POST*    | `post`    | `async_post`    | always   | always   |
| *PUT*     | `put`     | `async_put`     | optional | always   |
| *PATCH*   | `patch`   | `async_patch`   | optional | always   |
| *DELETE*  | `delete_` | `async_delete`  | optional | optional |
| *OPTIONS* | `options` | `async_options` | optional | never    |

|===

NOTE: The above functions are function objects, not functions.


The target type is `urls::url_view` for sessions, otherwise `urls::pct_string_view`.
The request type is `requests::http::headers` for sessions, otherwise `request_parameters`.
